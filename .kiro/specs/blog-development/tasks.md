# Implementation Plan: Blog Development

## Overview

Поэтапная реализация комплексной системы развития блога с фокусом на расширение контента, улучшение функциональности и оптимизацию пользовательского опыта. Реализация разделена на 5 фаз с инкрементальной валидацией через тесты.

## Tasks

- [x] 1. Подготовка инфраструктуры и утилит
  - [x] 1.1 Создать утилиты для SEO оптимизации
    - Реализовать функции генерации meta title (50-70 символов)
    - Реализовать функции генерации meta description (150-160 символов)
    - Реализовать функцию расчета keyword density
    - Реализовать функцию генерации canonical URLs
    - Реализовать функцию генерации structured data (Article schema)
    - _Requirements: 2.1, 2.2, 2.4, 2.5, 2.7_

  - [x] 1.2 Написать property тесты для SEO утилит
    - **Property 4: Meta Title Length** - мета заголовок 50-70 символов
    - **Property 5: Meta Description Length** - мета описание 150-160 символов
    - **Property 7: Canonical URL Generation** - корректный формат URL
    - **Property 10: Keyword Density** - плотность ключевых слов 1-3%
    - **Validates: Requirements 2.1, 2.2, 2.4, 2.7**

  - [x] 1.3 Создать утилиты для валидации контента
    - Реализовать функцию подсчета слов (word count)
    - Реализовать функцию расчета качества контента (quality score)
    - Реализовать функцию генерации slug из заголовка
    - Реализовать функцию расчета времени чтения
    - Реализовать функцию валидации H1 тегов
    - _Requirements: 1.3, 1.5, 2.6, 5.5, 9.2_

  - [x] 1.4 Написать property тесты для валидации контента
    - **Property 1: Content Validation** - статьи < 2000 слов отклоняются
    - **Property 3: Quality Score Threshold** - качество > 80
    - **Property 9: H1 Tag Validation** - один H1 с ключевым словом
    - **Property 20: Reading Time Calculation** - wordCount / 200
    - **Property 28: Slug Generation** - lowercase, дефисы, alphanumeric
    - **Validates: Requirements 1.3, 1.5, 2.6, 5.5, 9.2**

  - [x] 1.5 Создать утилиты для работы с изображениями
    - Реализовать функцию генерации alt tags
    - Реализовать функцию оптимизации изображений (WebP)
    - Реализовать функцию добавления lazy loading
    - _Requirements: 2.8, 5.6, 11.6_

  - [x] 1.6 Написать property тесты для работы с изображениями
    - **Property 11: Image Alt Tags** - все изображения имеют alt
    - **Property 21: Image Optimization** - WebP + lazy loading
    - **Property 34: Image Lazy Loading** - loading="lazy" для изображений ниже fold
    - **Validates: Requirements 2.8, 5.6, 11.6**

- [x] 2. Checkpoint - Проверка базовых утилит
  - Убедиться что все утилиты работают корректно
  - Проверить что property тесты проходят
  - Спросить пользователя если есть вопросы

- [x] 3. Расширение контента блога
  - [x] 3.1 Создать шаблоны для разных типов статей
    - Создать шаблон для гайдов (guides)
    - Создать шаблон для обзоров (reviews)
    - Создать шаблон для сравнений (comparisons)
    - _Requirements: 9.1_

  - [x] 3.2 Написать 11 новых статей для блога
    - Написать 2 статьи для категории "Авто и транспорт" (ОСАГО, КАСКО)
    - Написать 1 статью для категории "Зарплата и налоги" (Отпускные)
    - Написать 1 статью для категории "Зарплата и налоги" (Больничный)
    - Написать 1 статью для категории "Здоровье и фитнес" (ИМТ)
    - Написать 1 статью для категории "Инвестиции и вклады" (Вклады)
    - Написать 1 статью для категории "Инвестиции и вклады" (Инвестиции)
    - Написать 1 статью для категории "Юридические вопросы" (Госпошлины)
    - Написать 2 дополнительные статьи для популярных категорий
    - Убедиться что каждая статья > 2000 слов
    - Добавить связанные калькуляторы к каждой статье
    - _Requirements: 1.1, 1.3, 1.4_

  - [x] 3.3 Написать property тесты для контента
    - **Property 2: Calculator Linking** - каждая статья имеет связанные калькуляторы
    - **Property 6: Keyword Validation** - минимум 5 ключевых слов
    - **Property 8: Structured Data Presence** - валидная Article schema
    - **Validates: Requirements 1.4, 2.3, 2.5**

  - [x] 3.4 Оптимизировать существующие статьи
    - Обновить SEO метаданные для всех статей
    - Добавить structured data для всех статей
    - Оптимизировать изображения (WebP, alt tags)
    - Добавить внутренние ссылки между статьями
    - _Requirements: 2.1, 2.2, 2.5, 2.8_

- [x] 4. Checkpoint - Проверка контента
  - Убедиться что все 15+ статей опубликованы
  - Проверить что все категории покрыты
  - Проверить SEO оптимизацию
  - Спросить пользователя если есть вопросы

- [x] 5. Реализация системы поиска
  - [x] 5.1 Создать сервис поиска
    - Реализовать функцию полнотекстового поиска
    - Реализовать функцию токенизации и стемминга (русский язык)
    - Реализовать функцию расчета релевантности
    - Реализовать функцию подсветки совпадений
    - Реализовать функцию сортировки по релевантности
    - _Requirements: 3.1, 3.3, 3.4, 3.6, 3.7_

  - [x] 5.2 Написать property тесты для поиска
    - **Property 12: Search Coverage** - статьи с совпадениями в результатах
    - **Property 13: Search Result Highlighting** - подсветка ключевых слов
    - **Property 14: Search Relevance Sorting** - сортировка по релевантности
    - **Validates: Requirements 3.1, 3.3, 3.4, 3.7**

  - [x] 5.3 Создать компонент BlogSearch
    - Реализовать UI для поиска с debouncing (300ms)
    - Реализовать отображение результатов поиска
    - Реализовать подсветку совпадений в результатах
    - Добавить предложения альтернативных запросов
    - Добавить отображение популярных статей при отсутствии результатов
    - _Requirements: 3.1, 3.2, 3.3, 3.5, 3.7_

  - [x] 5.4 Написать unit тесты для BlogSearch
    - Тестировать debouncing поиска
    - Тестировать отображение результатов
    - Тестировать обработку пустых результатов
    - _Requirements: 3.2, 3.5_

- [x] 6. Реализация системы рекомендаций
  - [x] 6.1 Создать сервис рекомендаций
    - Реализовать функцию расчета similarity между статьями
    - Реализовать функцию получения похожих статей
    - Реализовать функцию получения связанных калькуляторов
    - Реализовать функцию фильтрации прочитанных статей
    - _Requirements: 4.1, 4.2, 4.3, 4.4, 4.6_

  - [x] 6.2 Написать property тесты для рекомендаций
    - **Property 15: Recommendation Count** - минимум 3 рекомендации
    - **Property 16: Same Category Priority** - приоритет той же категории
    - **Property 17: Exclude Read Articles** - исключение прочитанных
    - **Validates: Requirements 4.1, 4.4, 4.6**

  - [x] 6.3 Создать компонент BlogRecommendations
    - Реализовать отображение похожих статей
    - Реализовать отображение связанных калькуляторов
    - Добавить карточки рекомендаций с превью
    - _Requirements: 4.1, 4.3_

  - [x] 6.4 Написать unit тесты для BlogRecommendations
    - Тестировать отображение рекомендаций
    - Тестировать отображение калькуляторов
    - _Requirements: 4.1, 4.3_

- [x] 7. Checkpoint - Проверка поиска и рекомендаций
  - Убедиться что поиск работает корректно
  - Проверить что рекомендации релевантны
  - Проверить производительность поиска (< 500ms)
  - Спросить пользователя если есть вопросы

- [x] 8. Улучшение читабельности
  - [x] 8.1 Создать компонент BlogProgress
    - Реализовать индикатор прогресса чтения
    - Показывать прогресс только для статей > 1000 слов
    - Добавить sticky navigation с заголовком статьи
    - _Requirements: 5.1, 5.3_

  - [x] 8.2 Написать property тесты для прогресса чтения
    - **Property 18: Reading Progress Display** - отображение для статей > 1000 слов
    - **Validates: Requirements 5.1**

  - [x] 8.3 Создать компонент BlogTOC (Table of Contents)
    - Реализовать автоматическую генерацию оглавления
    - Генерировать TOC для статей с 5+ H2 заголовками
    - Добавить навигацию по якорям
    - Подсвечивать текущий раздел при скролле
    - _Requirements: 5.2_

  - [x] 8.4 Написать property тесты для TOC
    - **Property 19: Table of Contents Generation** - генерация для 5+ H2
    - **Validates: Requirements 5.2**

  - [x] 8.5 Добавить настройки читабельности
    - Реализовать переключатель размера шрифта (S/M/L)
    - Сохранять настройки в localStorage
    - Применять настройки ко всем статьям
    - _Requirements: 5.4_


- [-] 9. Реализация аналитики
  - [x] 9.1 Создать сервис аналитики
    - Реализовать функцию отслеживания page views
    - Реализовать функцию отслеживания reading time
    - Реализовать функцию отслеживания scroll depth (25%, 50%, 75%, 100%)
    - Реализовать функцию отслеживания кликов на калькуляторы
    - Реализовать функцию отслеживания поисковых запросов
    - Реализовать функцию отслеживания completion events
    - _Requirements: 6.1, 6.2, 6.3, 6.4, 6.5, 6.6_

  - [x] 9.2 Написать property тесты для аналитики
    - **Property 22: Analytics Event Recording** - корректная запись событий
    - **Validates: Requirements 6.1, 6.2, 6.3, 6.4, 6.5, 6.6**

  - [x] 9.3 Создать компонент BlogAnalytics
    - Интегрировать трекинг в BlogPostPage
    - Добавить трекинг скролла
    - Добавить трекинг кликов на калькуляторы
    - Добавить трекинг completion (100% scroll + 5s)
    - _Requirements: 6.1, 6.2, 6.3, 6.4, 6.6_

  - [x] 9.4 Написать unit тесты для BlogAnalytics
    - Тестировать запись page view
    - Тестировать расчет reading time
    - Тестировать определение scroll depth
    - _Requirements: 6.1, 6.2, 6.3_

- [x] 10. Реализация социальных функций
  - [x] 10.1 Создать компонент BlogShare
    - Реализовать кнопки шеринга (VK, Telegram, WhatsApp, Copy Link)
    - Реализовать генерацию Open Graph meta tags
    - Реализовать генерацию Twitter Card meta tags
    - Добавить трекинг шеринга
    - Отображать счетчик шеринга для статей с 10+ shares
    - _Requirements: 7.1, 7.2, 7.3, 7.4, 7.5, 7.6_

  - [x] 10.2 Написать property тесты для социальных функций
    - **Property 23: Open Graph Tags** - генерация OG тегов
    - **Property 24: Twitter Card Tags** - генерация Twitter Card тегов
    - **Property 25: Share Count Display** - отображение для 10+ shares
    - **Validates: Requirements 7.3, 7.4, 7.6**

  - [x] 10.3 Написать unit тесты для BlogShare
    - Тестировать открытие диалога шеринга
    - Тестировать копирование ссылки
    - Тестировать отображение счетчика
    - _Requirements: 7.2, 7.6_

- [x] 11. Checkpoint - Проверка UX улучшений
  - Убедиться что прогресс чтения работает
  - Проверить что TOC генерируется корректно
  - Проверить что аналитика записывает события
  - Проверить что шеринг работает
  - Спросить пользователя если есть вопросы

- [x] 12. Реализация системы комментариев
  - [x] 12.1 Создать сервис комментариев
    - Реализовать функцию валидации комментариев
    - Реализовать функцию постинга комментариев
    - Реализовать функцию ответов на комментарии (nested)
    - Реализовать функцию модерации комментариев
    - Реализовать функцию подсчета комментариев
    - _Requirements: 8.1, 8.2, 8.3, 8.5, 8.6_

  - [x] 12.2 Написать property тесты для комментариев
    - **Property 26: Comment Validation** - валидация имени и email
    - **Property 27: Comment Count Accuracy** - точный подсчет комментариев
    - **Validates: Requirements 8.2, 8.6**

  - [x] 12.3 Создать компонент BlogComments
    - Реализовать форму добавления комментария
    - Добавить валидацию полей (name, email, content)
    - Добавить CAPTCHA защиту
    - Реализовать отображение комментариев (nested)
    - Реализовать кнопку "Ответить"
    - Отображать счетчик комментариев
    - _Requirements: 8.1, 8.2, 8.4, 8.5, 8.6_

  - [x] 12.4 Написать unit тесты для BlogComments
    - Тестировать валидацию формы
    - Тестировать отображение комментариев
    - Тестировать nested replies
    - _Requirements: 8.2, 8.5_

  - [x] 12.5 Создать интерфейс модерации комментариев
    - Реализовать список комментариев на модерации
    - Добавить кнопки approve/reject/spam
    - Добавить уведомления модераторам
    - _Requirements: 8.3, 8.7_

- [x] 13. Автоматизация контента
  - [x] 13.1 Создать Content Manager утилиты
    - Реализовать функцию предложения тегов на основе контента
    - Реализовать функцию валидации ссылок на калькуляторы
    - Реализовать функцию проверки дубликатов контента
    - Реализовать функцию предложения похожих статей
    - _Requirements: 9.3, 9.4, 9.6, 9.7_

  - [x] 13.2 Написать property тесты для автоматизации
    - **Property 29: Tag Suggestion Relevance** - релевантность предложенных тегов
    - **Property 30: Link Validation** - валидация ссылок на калькуляторы
    - **Property 31: Duplicate Content Detection** - обнаружение дубликатов (> 80% similarity)
    - **Validates: Requirements 9.3, 9.4, 9.6**

- [x] 14. Checkpoint - Проверка комментариев и автоматизации
  - Убедиться что комментарии работают
  - Проверить модерацию комментариев
  - Проверить автоматизацию контента
  - Спросить пользователя если есть вопросы

- [x] 15. Подготовка к мультиязычности
  - [x] 15.1 Рефакторинг структуры данных
    - Обновить BlogPost для поддержки языков
    - Добавить поле language в BlogPost
    - Добавить поле translations в BlogPost
    - Обновить роутинг для поддержки /ru/blog/ и /en/blog/
    - _Requirements: 10.1, 10.2_

  - [x] 15.2 Реализовать языковые SEO метаданные
    - Реализовать функцию генерации hreflang tags
    - Обеспечить раздельные SEO метаданные для каждого языка
    - _Requirements: 10.5, 10.6_

  - [x] 15.3 Написать property тесты для мультиязычности
    - **Property 32: Language-Specific SEO** - раздельные SEO метаданные
    - **Property 33: Hreflang Tags** - генерация hreflang тегов
    - **Validates: Requirements 10.5, 10.6**

  - [x] 15.4 Создать компонент языкового переключателя
    - Реализовать UI переключателя языков
    - Сохранять выбранный язык в localStorage
    - Обновлять контент при смене языка
    - _Requirements: 10.3, 10.4_

- [x] 16. Оптимизация производительности
  - [x] 16.1 Оптимизация загрузки
    - Реализовать code splitting для blog компонентов
    - Реализовать lazy loading для комментариев
    - Реализовать prefetching для связанных статей
    - Добавить preload для критических ресурсов (fonts, CSS)
    - _Requirements: 11.3, 11.5_

  - [x] 16.2 Оптимизация изображений
    - Конвертировать все изображения в WebP
    - Генерировать responsive images (srcset)
    - Реализовать blur-up placeholder
    - Добавить lazy loading для изображений ниже fold
    - _Requirements: 5.6, 11.6_

  - [x] 16.3 Написать unit тесты для оптимизации
    - Тестировать lazy loading изображений
    - Тестировать code splitting
    - _Requirements: 11.3, 11.6_

  - [x] 16.4 Реализовать кеширование
    - Реализовать service worker для кеширования статей
    - Реализовать кеширование результатов поиска (5 минут)
    - Реализовать localStorage кеш для статей
    - _Requirements: 11.4_

  - [x] 16.5 Оптимизация клиентской навигации
    - Реализовать client-side routing между статьями
    - Добавить transitions при навигации
    - Prefetch статей при hover на ссылках
    - _Requirements: 11.7_

- [x] 17. Checkpoint - Проверка производительности
  - Запустить Lighthouse audit (target: 90+)
  - Проверить время загрузки (target: < 2s)
  - Проверить время поиска (target: < 500ms)
  - Оптимизировать bundle size (target: < 200KB gzipped)
  - Спросить пользователя если есть вопросы

- [x] 18. Улучшение доступности
  - [x] 18.1 Аудит и исправление доступности
    - Проверить heading hierarchy во всех статьях
    - Проверить color contrast (минимум 4.5:1)
    - Добавить alt text ко всем изображениям
    - Добавить skip-to-content link
    - Обеспечить keyboard navigation для всех элементов
    - _Requirements: 12.2, 12.3, 12.4, 12.5, 12.6_

  - [x] 18.2 Написать property тесты для доступности
    - **Property 35: Heading Hierarchy** - корректная иерархия заголовков
    - **Property 36: Color Contrast** - контраст минимум 4.5:1
    - **Property 37: Alt Text Presence** - alt text для всех изображений
    - **Property 38: Semantic HTML** - использование semantic элементов
    - **Validates: Requirements 12.2, 12.3, 12.4, 12.7**

  - [x] 18.3 Написать unit тесты для keyboard navigation
    - Тестировать Tab navigation
    - Тестировать Escape для закрытия модалов
    - Тестировать skip-to-content link
    - _Requirements: 12.5, 12.6_

  - [x] 18.4 Тестирование с screen readers
    - Протестировать с NVDA (Windows)
    - Протестировать с VoiceOver (macOS)
    - Исправить найденные проблемы
    - _Requirements: 12.1_

- [x] 19. Финальное тестирование и оптимизация
  - [x] 19.1 End-to-end тестирование
    - Написать E2E тесты для основных сценариев (Playwright)
    - Тестировать поиск статей
    - Тестировать чтение статьи с прогрессом
    - Тестировать клики на калькуляторы
    - Тестировать шеринг статей
    - Тестировать постинг комментариев

  - [x] 19.2 Кросс-браузерное тестирование
    - Тестировать в Chrome
    - Тестировать в Firefox
    - Тестировать в Safari
    - Тестировать в Edge
    - Исправить найденные проблемы

  - [x] 19.3 Мобильное тестирование
    - Тестировать на iOS Safari
    - Тестировать на Android Chrome
    - Проверить responsive design
    - Проверить touch interactions
    - Исправить найденные проблемы

  - [x] 19.4 Финальная оптимизация
    - Запустить финальный Lighthouse audit
    - Оптимизировать критические метрики (FCP, LCP, TTI)
    - Минимизировать bundle size
    - Оптимизировать изображения

- [x] 20. Checkpoint - Финальная проверка
  - Убедиться что все тесты проходят
  - Проверить Lighthouse score (target: 90+)
  - Проверить WCAG 2.1 Level AA compliance
  - Проверить все 15+ статей опубликованы
  - Проверить все функции работают корректно
  - Спросить пользователя готовы ли к деплою

- [x] 21. Деплой и мониторинг
  - [x] 21.1 Подготовка к деплою
    - Обновить sitemap.xml с новыми статьями
    - Обновить robots.txt
    - Настроить redirects для старых URL (если нужно)
    - Создать backup текущей версии

  - [x] 21.2 Деплой на production
    - Задеплоить новую версию
    - Проверить что все работает на production
    - Мониторить ошибки в Sentry
    - Мониторить метрики в Google Analytics

  - [x] 21.3 Настройка мониторинга
    - Настроить Google Analytics для блога
    - Настроить Yandex Metrika
    - Настроить custom analytics dashboard
    - Настроить алерты для критических ошибок

  - [x] 21.4 SEO продвижение
    - Отправить новые статьи в Google Search Console
    - Отправить новые статьи в Yandex Webmaster
    - Создать social media посты для новых статей
    - Добавить внутренние ссылки из калькуляторов на статьи

## Notes

- Все тесты являются обязательными для обеспечения качества и корректности
- Каждая задача ссылается на конкретные требования для отслеживаемости
- Checkpoints обеспечивают инкрементальную валидацию
- Property тесты валидируют универсальные свойства корректности
- Unit тесты валидируют конкретные примеры и edge cases
- Фокус на инкрементальной разработке с частой валидацией
