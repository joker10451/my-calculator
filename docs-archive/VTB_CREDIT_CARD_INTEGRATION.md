# Интеграция кредитной карты ВТБ

## Обзор

Добавлена партнерская интеграция кредитной карты ВТБ с полным соблюдением требований рекламного законодательства РФ.

## Созданные файлы

### Конфигурация

1. **`src/config/vtbCreditCard.ts`** - Основная конфигурация продукта
   - Содержит все данные о кредитной карте
   - Скрывает комиссию от публичного API
   - Включает валидацию данных
   - Содержит все обязательные дисклеймеры

2. **`src/config/affiliateLinks.ts`** - Обновлен с добавлением партнерской ссылки ВТБ
   - Добавлена ссылка `vtb-credit-card`
   - URL: `https://trk.ppdu.ru/click/q3zhF1ow?erid=2SDnjeGCc2T`
   - erid: `2SDnjeGCc2T`

### Компоненты

3. **`src/components/VTBCreditCardWidget.tsx`** - Виджет отображения карты
   - Два варианта: `compact` и `full`
   - Интеграция с системой аналитики
   - Accessibility-compliant
   - Отображение обязательных дисклеймеров

4. **`src/components/VTBCreditCardErrorBoundary.tsx`** - Error boundary
   - Graceful degradation при ошибках
   - Fallback UI

5. **`src/pages/VTBCreditCardDemo.tsx`** - Демо-страница
   - Примеры использования виджета
   - Оба варианта отображения

## Основные характеристики продукта

### Условия кредитования
- **Кредитный лимит**: до 1 000 000 ₽
- **Без подтверждения дохода**: до 300 000 ₽
- **Льготный период**: 
  - До 200 дней для рефинансирования
  - До 100 дней для покупок
- **Процентная ставка**: от 49.9%
- **ПСК**: 47.000%-49.900%

### Кешбэк
- До 15% в выбранных категориях
- 3 категории для обычных клиентов
- 4 категории для зарплатных клиентов
- Максимум 3 000 ₽ в месяц

### Комиссии
- **Обслуживание**: 0 ₽
- **Снятие наличных**: 
  - 0 ₽ до 50 000 ₽ в первые 30 дней
  - 5.9% + 590 ₽ в остальных случаях
- **Минимальный платеж**: 3% от задолженности

### Партнерские условия
- **Cookie TTL**: 30 дней
- **Hold период**: 30 дней
- **CR**: 7.92%
- **AR**: 0.94%
- **EPC**: 2.32 ₽
- **EPL**: 29.30 ₽

## Использование

### Базовое использование

```tsx
import { VTBCreditCardWidget } from '@/components/VTBCreditCardWidget';
import { VTBCreditCardErrorBoundary } from '@/components/VTBCreditCardErrorBoundary';

function MyPage() {
  return (
    <VTBCreditCardErrorBoundary>
      <VTBCreditCardWidget 
        source="calculator" 
        variant="full"
        showDetails={true}
      />
    </VTBCreditCardErrorBoundary>
  );
}
```

### Компактный вариант

```tsx
<VTBCreditCardWidget 
  source="sidebar" 
  variant="compact"
  showDetails={false}
/>
```

### Параметры компонента

- **`source`** (обязательный): Источник для аналитики
  - `'calculator'` - на странице калькулятора
  - `'blog'` - в блоге
  - `'sidebar'` - в боковой панели
  - `'demo_page'` - на демо-странице
  
- **`variant`**: Вариант отображения
  - `'compact'` - компактный (3 преимущества)
  - `'full'` - полный (все преимущества + дисклеймеры)
  
- **`showDetails`**: Показывать детальную информацию
  - `true` - показать все детали
  - `false` - минимальная информация
  
- **`className`**: Дополнительные CSS классы

## Соответствие требованиям

### ФЗ "О рекламе"

✅ **Обязательные фразы** (занимают не менее 10% пространства):
- "Оценивайте свои финансовые возможности и риски"
- "Изучите все условия кредита на vtb.ru/personal/karty/kreditnye/vozmozhnosti"

✅ **ПСК**: Указывается при упоминании процентной ставки

✅ **erid**: Отображается в каждом рекламном материале

### Валидация рекламных материалов

```typescript
import { validateAdvertisingMaterial } from '@/config/vtbCreditCard';

const violations = validateAdvertisingMaterial({
  text: 'Ваш рекламный текст',
  hasRatesMention: true,
  disclaimerSize: 15 // процент от пространства
});

if (violations.length > 0) {
  console.error('Нарушения:', violations);
}
```

## Аналитика

### Отслеживаемые события

1. **`vtb_credit_card_view`** - Просмотр виджета
   - `source` - источник
   - `productId` - ID продукта
   - `variant` - вариант отображения

2. **`vtb_credit_card_click`** - Клик по кнопке
   - `source` - источник
   - `productId` - ID продукта
   - `bankId` - ID банка

### Интеграция с системой трекинга

Виджет автоматически интегрируется с:
- Yandex Metrica
- Системой трекинга рефералов
- Внутренней аналитикой

## API

### Получение данных карты

```typescript
import { VTB_CREDIT_CARD_DATA } from '@/config/vtbCreditCard';

console.log(VTB_CREDIT_CARD_DATA.name); // "Кредитная карта"
console.log(VTB_CREDIT_CARD_DATA.features); // массив преимуществ
```



### Получение дисклеймера

```typescript
import { getAdvertisingDisclaimer } from '@/config/vtbCreditCard';

const disclaimer = getAdvertisingDisclaimer(true); // с ПСК
```

### Получение партнерской ссылки

```typescript
import { getAffiliateLink } from '@/config/affiliateLinks';

const link = getAffiliateLink('vtb', 'credit', 'vtb-credit-card');
// https://trk.ppdu.ru/click/q3zhF1ow?erid=2SDnjeGCc2T
```

## Целевое действие

**Описание**: Кредитная карта – выдача + POS-транзакция на любую сумму

**Сроки атрибуции**:
- 30 дней на получение карты со дня одобрения
- 30 дней на совершение POS-активации со дня получения карты

**Важно**: При одновременном открытии двух карт оплате подлежит только одна из них.

## Требования к заемщику

- Гражданство РФ
- Постоянная регистрация в регионе присутствия банка
- Официальный доход от 5 000 ₽/мес

**Документы**:
- До 300 000 ₽: Паспорт РФ
- От 300 000 ₽: Паспорт РФ + справка 2-НДФЛ или справка по форме банка

## Поиск потерянных выдач

Осуществляется по заявкам, у которых с момента совершения целевого действия прошло не более 3 месяцев.

**Важно**: Если были нарушены правила оффера или вид трафика не был согласован, поиск потерянной выдачи не производится.

## Дальнейшие шаги

1. ✅ Создана конфигурация продукта
2. ✅ Создан виджет отображения
3. ✅ Добавлена партнерская ссылка
4. ✅ Создана демо-страница
5. ⏳ Добавить виджет на страницы калькуляторов
6. ⏳ Добавить в систему рекомендаций
7. ⏳ Настроить A/B тестирование
8. ⏳ Добавить в блог-посты

## Тестирование

Для тестирования виджета:

1. Запустите dev-сервер: `npm run dev`
2. Откройте демо-страницу: `/vtb-credit-card-demo`
3. Проверьте оба варианта отображения
4. Проверьте клик по кнопке (откроется партнерская ссылка)
5. Проверьте события в Yandex Metrica

## Поддержка

При возникновении вопросов или проблем:
- Проверьте консоль браузера на наличие ошибок
- Убедитесь, что все зависимости установлены
- Проверьте, что партнерская ссылка активна
- Проверьте настройки Yandex Metrica

---

**Дата создания**: 14 января 2026  
**Версия**: 1.0.0  
**Статус**: ✅ Готово к использованию
